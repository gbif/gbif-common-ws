<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>BaseWsGetClient.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">GBIF Common Web service</a> &gt; <a href="index.source.html" class="el_package">org.gbif.ws.client</a> &gt; <span class="el_source">BaseWsGetClient.java</span></div><h1>BaseWsGetClient.java</h1><pre class="source lang-java linenums">package org.gbif.ws.client;

import java.util.Locale;
import javax.annotation.Nullable;
import javax.ws.rs.core.MediaType;

import com.sun.jersey.api.client.WebResource;
import com.sun.jersey.api.client.filter.ClientFilter;

/**
 * Base client providing a get by key method for a specific entity type T.
 * The client applies a json media type and provides various convenience methods to execute CRUD requests
 * and can be configured to work with authentication.
 * The client can return other types than the main T class via generic types passed in.
 *
 * @param &lt;T&gt; the main entity class
 * @param &lt;K&gt; the key class of the main entity
 */
public abstract class BaseWsGetClient&lt;T, K&gt; extends BaseWsClient {

  protected final Class&lt;T&gt; resourceClass;

  /**
   * @param resourceClass the main entity class
   * @param resource      the base url to the underlying webservice
   * @param authFilter    optional authentication filter, can be null
   */
  protected BaseWsGetClient(Class&lt;T&gt; resourceClass, WebResource resource, @Nullable ClientFilter authFilter) {
<span class="nc" id="L29">    super(resource);</span>
<span class="nc" id="L30">    this.resourceClass = resourceClass;</span>
<span class="nc bnc" id="L31" title="All 2 branches missed.">    if (authFilter != null) {</span>
<span class="nc" id="L32">      this.resource.addFilter(authFilter);</span>
    }
<span class="nc" id="L34">  }</span>

  /**
   * Gets a resource by its key by executing a json type http GET request.
   * The clients resourceClass is used to convert the response into an object.
   *
   * @return requested resource or {@code null} if it couldn't be found
   */
  @Nullable
  public T get(K key) {
<span class="nc bnc" id="L44" title="All 2 branches missed.">    if (key == null) {</span>
<span class="nc" id="L45">      throw new IllegalArgumentException(&quot;Key cannot be null&quot;);</span>
    }
<span class="nc" id="L47">    return resource.path(key.toString()).type(MediaType.APPLICATION_JSON).get(resourceClass);</span>
  }

  /**
   * Executes a json type http GET request with paths added to base resource.
   * The clients resourceClass is used to convert the response into an object.
   *
   * @param path optional paths to be appended to the base resource
   *
   * @return requested resource or null
   */
  @Nullable
  protected T get(String... path) {
<span class="nc" id="L60">    return getResource(path).type(MediaType.APPLICATION_JSON).get(resourceClass);</span>
  }

  /**
   * Gets a resource by its key by executing a json type http GET request.
   * Also applies a language http header.
   * The clients resourceClass is used to convert the response into an object.
   *
   * @param key    primary key for base resource class
   * @param locale identifier for a region
   *
   * @return requested resource or null
   */
  @Nullable
  protected T get(K key, Locale locale) {
<span class="nc bnc" id="L75" title="All 2 branches missed.">    if (key == null) {</span>
<span class="nc" id="L76">      throw new IllegalArgumentException(&quot;Key cannot be null&quot;);</span>
    }
<span class="nc" id="L78">    return get(locale, key.toString());</span>
  }

  /**
   * Gets a resource by a path by executing a json type http GET request.
   * Also applies a language http header.
   * The clients resourceClass is used to convert the response into an object.
   *
   * @param locale identifier for a region.
   * @param path   optional paths to be appended to the base resource.
   *
   * @return requested resource or null
   */
  @Nullable
  protected T get(Locale locale, String... path) {
<span class="nc" id="L93">    WebResource.Builder res = getResource(path).type(MediaType.APPLICATION_JSON);</span>
<span class="nc bnc" id="L94" title="All 2 branches missed.">    if (locale != null) {</span>
<span class="nc" id="L95">      res = res.acceptLanguage(locale);</span>
    }
<span class="nc" id="L97">    return res.get(resourceClass);</span>
  }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.3.201901230119</span></div></body></html>